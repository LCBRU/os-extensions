<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE hibernate-mapping PUBLIC
    "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
    "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">

<hibernate-mapping auto-import="false">
  <class name="com.krishagni.openspecimen.redcap.Record" table="OS_REDCAP_RECORDS">
    <id name="id" column="IDENTIFIER">
      <generator class="native">
        <param name="sequence">OS_REDCAP_RECORDS_SEQ</param>
      </generator>
    </id>

    <property name="recordId" column="RECORD_ID"/>

    <many-to-one name="project" class="com.krishagni.openspecimen.redcap.Project" column="PROJECT_ID"/>

    <property name="cprId" column="CPR_ID"/>

    <property name="visitId" column="VISIT_ID"/>

    <query name="getByRecordId">
      select
        r
      from 
        com.krishagni.openspecimen.redcap.Record r
        join r.project p
      where
        p.id = :projectId and
        r.recordId = :recordId
    </query>
  </class>
</hibernate-mapping>
